{% extends 'base.html' %}

{% block title %}Play{% endblock %}

{% block content %}
    <h1>{{ user.username }}</h1>
    <h2>You're at question {{ question_level }}</h2>
    <h3>Story</h3>
    <p>{{ question_story }}</p>
    <h3>Question</h3>
    <p>{{ question_text }}</p>

    <form action="{% url 'play' %}" method="POST" id="ans-form">
        {% csrf_token %}
        <label for="answer">Answer:</label>
        <input name="answer" id = "answer" type="text">
        <p><input type="submit">Submit</p>
    </form>

    <p id='response'></div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

    <script type="text/javascript">
        var frm = $('#ans-form');
        frm.submit(function () {
            $.ajax({
                type: frm.attr('method'),
                url: frm.attr('action'),
                data: frm.serialize(),
                success: function (data) {
                    if (data['isCorrect'] == 'false') {
                        $("#response").html(data['responseText']);
                    }
                    else {
                        window.location.href = "{% url 'play' %}"
                    }
                },
                error: function(data) {
                    $("#response").html("Something went wrong!");
                }
            });
            return false;
        });
    </script>
{% endblock %}